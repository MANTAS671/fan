<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>–¢—ã —Ç–æ—á–Ω–æ –Ω–µ –ê–ª–µ–∫—Å–µ–π? ‚Äî Next Gen 1.4</title>
<style>
    /* –°—Ç–∏–ª—å –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è –≤ –º–µ–º–Ω–æ-–∏—Ä–æ–Ω–∏—á–Ω–æ–º "Next Gen 1.4" —Å—Ç–∏–ª–µ */
    body {
        font-family: sans-serif;
        background: #222;
        color: #eee;
        text-align: center;
        margin: 0;
        padding: 0;
    }
    h1 {
        margin: 20px 0;
        font-size: 1.5em;
    }
    #score {
        font-size: 1.2em;
        margin: 5px;
    }
    /* –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä –∫—Ä–µ–¥–∏—Ç–Ω—ã—Ö –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–µ–π (–∏–∫–æ–Ω–∫–∏ –∫—Ä–µ–¥–∏—Ç–æ–∫) */
    #creditIndicator {
        margin: 5px;
        font-size: 1.1em;
    }
    /* –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–æ–ª–≥–∞ (–ø—Ä–æ–≥—Ä–µ—Å—Å–±–∞—Ä —Ä–∞—Å—Å—Ä–æ—á–∫–∏) */
    #debtLabel {
        margin: 5px;
    }
    #debtContainer {
        margin: 5px auto;
        width: 80%;
        max-width: 300px;
        background: #555;
        border-radius: 5px;
        overflow: hidden;
        height: 20px;
        display: none; /* —Å–∫—Ä—ã—Ç, –µ—Å–ª–∏ –¥–æ–ª–≥–∞ –Ω–µ—Ç */
    }
    #debtFill {
        background: #f00;
        height: 100%;
        width: 0%;
        transition: width 0.5s;
    }
    /* –¶–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π —ç–ª–µ–º–µ–Ω—Ç (–∫–ª–∏–∫–∞–±–µ–ª—å–Ω—ã–π) */
    #central {
        display: inline-block;
        cursor: pointer;
        margin: 20px;
        position: relative;
    }
    /* –°—Ç–∏–ª–∏ –¥–ª—è –∫–∞—Å—Ç–æ–º–Ω–æ–π "–≤–∏–¥–µ–æ–∫–∞—Ä—Ç—ã" (–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–æ–≥–æ –æ–±—ä–µ–∫—Ç–∞ –¥–ª—è –∫–ª–∏–∫–æ–≤) */
    #gpuIcon {
        position: relative;
        width: 200px;
        height: 100px;
        background: #555;
        border: 4px solid #333;
        border-radius: 10px;
        margin: 0 auto;
        transition: transform 0.1s;
    }
    /* –°—Ç–∏–ª–∏ –¥–ª—è —Å–æ—Å—Ç–æ—è–Ω–∏–π –≤–∏–¥–µ–æ–∫–∞—Ä—Ç—ã –ø—Ä–∏ –∫–ª–∏–∫–µ –∏ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–º –∞–ø–≥—Ä–µ–π–¥–µ */
    #gpuIcon.clicked {
        transform: scale(1.1);
        box-shadow: 0 0 10px #0ff;
    }
    #gpuIcon.maxed {
        border-color: #0f0;
        box-shadow: 0 0 20px #0f0;
    }
    /* –í–µ–Ω—Ç–∏–ª—è—Ç–æ—Ä—ã –Ω–∞ –≤–∏–¥–µ–æ–∫–∞—Ä—Ç–µ */
    .fan {
        position: absolute;
        top: 30px;
        width: 40px;
        height: 40px;
        border-radius: 50%;
        background: #111;
        border: 4px solid #333;
    }
    .fan::after {
        content: "";
        position: absolute;
        top: 12px;
        left: 12px;
        width: 16px;
        height: 16px;
        background: #666;
        border-radius: 50%;
    }
    .fan1 { left: 20px; }
    .fan2 { left: 80px; }
    .fan3 { left: 140px; }
    /* "–ó–æ–ª–æ—Ç–æ–π" —Ä–∞–∑—ä—ë–º (PCI-Express connector) */
    .connector {
        position: absolute;
        left: 15px;
        bottom: -5px;
        width: 50px;
        height: 10px;
        background: linear-gradient(to right, #DAA520, #FFD700);
    }
    /* –ú–µ—Ç–∫–∞ –Ω–∞–∑–≤–∞–Ω–∏—è –≤–∏–¥–µ–æ–∫–∞—Ä—Ç—ã –Ω–∞ –∫–∞—Ä—Ç–µ */
    #gpuLabel {
        position: absolute;
        bottom: 5px;
        right: 5px;
        font-size: 10px;
        color: #fff;
        text-shadow: 0 0 2px #000;
        white-space: nowrap;
    }
    /* –°—Ç–∏–ª–∏ –¥–ª—è –≤—ã–ª–µ—Ç–∞—é—â–∏—Ö —á–∞—Å—Ç–∏—Ü –ø—Ä–∏ –∫–ª–∏–∫–µ (+FPS) */
    .particle {
        position: absolute;
        font-weight: bold;
        color: #0f0;
        pointer-events: none;
        text-shadow: 0 0 5px #0f0;
        animation: floatUp 1s ease-out forwards;
    }
    @keyframes floatUp {
        0% {
            opacity: 1;
            transform: translateY(0);
        }
        100% {
            opacity: 0;
            transform: translateY(-50px);
        }
    }
    /* –ö–Ω–æ–ø–∫–∏ –∞–ø–≥—Ä–µ–π–¥–æ–≤ */
    #upgrades {
        display: flex;
        flex-wrap: wrap;
        justify-content: center;
        margin: 10px;
    }
    .upgrade-btn {
        background: #444;
        color: #eee;
        border: 2px solid #666;
        padding: 8px;
        margin: 5px;
        border-radius: 5px;
        cursor: pointer;
        min-width: 100px;
        font-size: 0.9em;
    }
    .upgrade-btn:disabled {
        opacity: 0.5;
        cursor: default;
    }
    .upgrade-btn:hover:enabled {
        background: #555;
    }
    /* –ü–∞–Ω–µ–ª—å —Å–æ—Å—Ç–æ—è–Ω–∏—è —Å–±–æ—Ä–∫–∏ (—Å–ø–∏—Å–æ–∫ —Ç–µ–∫—É—â–∏—Ö –∫–æ–º–ø–ª–µ–∫—Ç—É—é—â–∏—Ö) */
    #buildStatus {
        width: 90%;
        max-width: 400px;
        margin: 20px auto;
        text-align: left;
        background: #333;
        padding: 10px;
        border-radius: 5px;
    }
    #buildStatus h3 {
        text-align: center;
        margin: 5px 0 10px;
        font-size: 1.1em;
    }
    .part {
        margin: 4px 0;
    }
    /* –ë–ª–æ–∫ —Å–æ–æ–±—â–µ–Ω–∏–π (–¥–ª—è –≤—Å–ø–ª—ã–≤–∞—é—â–∏—Ö —à—É—Ç–æ–∫/—É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π) */
    #messageBox {
        margin: 10px;
        min-height: 20px;
        font-size: 0.95em;
        color: #ff0;
    }
</style>
</head>
<body>

<h1>–¢—ã —Ç–æ—á–Ω–æ –Ω–µ –ê–ª–µ–∫—Å–µ–π? ‚Äî Next Gen 1.4</h1>
<div id="score">FPS: 0</div>
<div id="creditIndicator">–ö—Ä–µ–¥–∏—Ç–∫–∏: <span id="creditIcons">üí≥üí≥üí≥</span></div>
<div id="debtLabel" style="display:none;">–î–æ–ª–≥: <span id="debtAmount">0</span> FPS</div>
<div id="debtContainer"><div id="debtFill"></div></div>

<div id="central">
    <!-- –¶–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π –∫–ª–∏–∫–∞–±–µ–ª—å–Ω—ã–π —ç–ª–µ–º–µ–Ω—Ç (–≤–∏–¥–µ–æ–∫–∞—Ä—Ç–∞ –≤ –≤–∏–¥–µ –º–µ–º–Ω–æ–≥–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è) -->
    <div id="gpuIcon">
        <div class="fan fan1"></div>
        <div class="fan fan2"></div>
        <div class="fan fan3"></div>
        <div class="connector"></div>
        <div id="gpuLabel"></div>
    </div>
</div>

<div id="upgrades"></div>

<div id="buildStatus">
    <h3>–¢–≤–æ–π –±–∏–ª–¥:</h3>
    <div id="partsList"></div>
</div>

<div id="messageBox"></div>

<script>
/* –õ–æ–≥–∏–∫–∞ –∏–≥—Ä—ã-–∫–ª–∏–∫–µ—Ä–∞ "–¢—ã —Ç–æ—á–Ω–æ –Ω–µ –ê–ª–µ–∫—Å–µ–π? ‚Äî Next Gen 1.4" */
window.addEventListener('load', function() {
    // –î–∞–Ω–Ω—ã–µ –æ–± –∞–ø–≥—Ä–µ–π–¥–∞—Ö –∫–æ–º–ø–ª–µ–∫—Ç—É—é—â–∏—Ö
    const parts = {
        gpu: {
            name: "–í–∏–¥–µ–æ–∫–∞—Ä—Ç–∞",
            level: 0,
            effect: 5, // –¥–æ–±–∞–≤–∫–∞ FPS –∑–∞ —É—Ä–æ–≤–µ–Ω—å
            cost: [20, 100, 500, 2000, 10000],
            names: ["–ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –≤–∏–¥–µ–æ", "GeForce GTX 480", "GeForce GTX 1080 Ti (–ë–£)", "RTX 3060", "RTX 4090", "RTX 9090"]
        },
        cpu: {
            name: "–ü—Ä–æ—Ü–µ—Å—Å–æ—Ä",
            level: 0,
            effect: 4,
            cost: [15, 75, 300, 1500, 6000],
            names: ["Pentium II 300 MHz", "Intel Pentium 4", "Intel Core i3", "AMD Ryzen 5 3600", "Intel Core i9-13900K", "–ö–≤–∞–Ω—Ç–æ–≤—ã–π CPU"]
        },
        ram: {
            name: "–û–ø–µ—Ä–∞—Ç–∏–≤–Ω–∞—è –ø–∞–º—è—Ç—å",
            level: 0,
            effect: 3,
            cost: [10, 50, 250, 1000, 4000],
            names: ["DDR 512 MB", "DDR2 2 GB", "DDR3 8 GB", "DDR4 16 GB", "DDR5 32 GB", "DDR6 128 GB"]
        },
        cooler: {
            name: "–û—Ö–ª–∞–∂–¥–µ–Ω–∏–µ",
            level: 0,
            effect: 2,
            cost: [5, 25, 100, 500, 2000],
            names: ["–°—Ç–æ–∫–æ–≤—ã–π –∫—É–ª–µ—Ä", "–ö—É–ª–µ—Ä —Å –±–∞–∑–∞—Ä–∞", "–ë–∞—à–µ–Ω–Ω—ã–π –∫—É–ª–µ—Ä", "–°–í–û (–≤–æ–¥—è–Ω–æ–µ)", "–ñ–∏–¥–∫–∏–π –∞–∑–æ—Ç", "–ö—Ä–∏–æ-–∑–∞–º–æ—Ä–æ–∑–∫–∞"]
        },
        case: {
            name: "–ö–æ—Ä–ø—É—Å",
            level: 0,
            effect: 1,
            cost: [3, 15, 60, 300, 1200],
            names: ["–ö–æ—Ä–æ–±–∫–∞ –∏–∑-–ø–æ–¥ –æ–±—É–≤–∏", "–ü–æ–¥–µ—Ä–∂–∞–Ω–Ω—ã–π –∫–æ—Ä–ø—É—Å", "–û–±—ã—á–Ω—ã–π –∫–æ—Ä–ø—É—Å", "–ò–≥—Ä–æ–≤–æ–π –∫–æ—Ä–ø—É—Å —Å RGB", "–ü—Ä–æ–∑—Ä–∞—á–Ω—ã–π –∫–æ—Ä–ø—É—Å", "–ó–æ–ª–æ—Ç–æ–π –∫–æ—Ä–ø—É—Å"]
        }
    };
    // –ì–µ–Ω–∏—Ç–∏–≤–Ω—ã–µ –Ω–∞–∑–≤–∞–Ω–∏—è –¥–ª—è –∫–Ω–æ–ø–æ–∫ (–∫–æ–≥–æ/—á–µ–≥–æ –∞–ø–≥—Ä–µ–π–¥–∏–º)
    const partGenitive = {
        gpu: "–≤–∏–¥–µ–æ–∫–∞—Ä—Ç—ã",
        cpu: "–ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–∞",
        ram: "–æ–ø–µ—Ä–∞—Ç–∏–≤–∫–∏",
        cooler: "–∫—É–ª–µ—Ä–∞",
        case: "–∫–æ—Ä–ø—É—Å–∞"
    };

    // –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è –∏–≥—Ä—ã
    let points = 0;               // —Ç–µ–∫—É—â–∏–µ –æ—á–∫–∏ (FPS)
    let pointsPerClick = 1;       // FPS –∑–∞ –æ–¥–∏–Ω –∫–ª–∏–∫ (—É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç—Å—è –∞–ø–≥—Ä–µ–π–¥–∞–º–∏)
    let debt = 0;                 // —Ç–µ–∫—É—â–∏–π –¥–æ–ª–≥ (–Ω–µ–æ–ø–ª–∞—á–µ–Ω–Ω—ã–µ FPS)
    let totalDebtIncurred = 0;    // —Å—É–º–º–∞ –¥–æ–ª–≥–∞, –∫–æ—Ç–æ—Ä–∞—è –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –≤—ã–ø–ª–∞—á–µ–Ω–∞ (–¥–ª—è –ø—Ä–æ–≥—Ä–µ—Å—Å–±–∞—Ä–∞)
    let creditCount = 0;          // —Å–∫–æ–ª—å–∫–æ –∞–ø–≥—Ä–µ–π–¥–æ–≤ –≤–∑—è—Ç–æ –≤ –∫—Ä–µ–¥–∏—Ç –ø–æ–¥—Ä—è–¥

    // –°—Å—ã–ª–∫–∏ –Ω–∞ —ç–ª–µ–º–µ–Ω—Ç—ã –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
    const scoreEl = document.getElementById('score');
    const debtLabelEl = document.getElementById('debtLabel');
    const debtAmountEl = document.getElementById('debtAmount');
    const debtFillEl = document.getElementById('debtFill');
    const creditIconsEl = document.getElementById('creditIcons');
    const gpuLabelEl = document.getElementById('gpuLabel');
    const gpuIconEl = document.getElementById('gpuIcon');
    const upgradesContainer = document.getElementById('upgrades');
    const partsListEl = document.getElementById('partsList');
    const messageBoxEl = document.getElementById('messageBox');

    // –§—É–Ω–∫—Ü–∏—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è –≤ localStorage
    function saveState() {
        const state = {
            points: points,
            debt: debt,
            totalDebtIncurred: totalDebtIncurred,
            creditCount: creditCount,
            partsLevels: {}
        };
        for (let key in parts) {
            state.partsLevels[key] = parts[key].level;
        }
        localStorage.setItem('nextgen14_save', JSON.stringify(state));
    }

    // –§—É–Ω–∫—Ü–∏—è –∑–∞–≥—Ä—É–∑–∫–∏ —Å–æ—Å—Ç–æ—è–Ω–∏—è –∏–∑ localStorage
    function loadState() {
        const saved = localStorage.getItem('nextgen14_save');
        if (!saved) return;
        try {
            const state = JSON.parse(saved);
            if (state && typeof state === 'object') {
                if (typeof state.points === 'number') points = state.points;
                if (typeof state.debt === 'number') debt = state.debt;
                if (typeof state.totalDebtIncurred === 'number') totalDebtIncurred = state.totalDebtIncurred;
                if (typeof state.creditCount === 'number') creditCount = state.creditCount;
                if (state.partsLevels) {
                    for (let key in state.partsLevels) {
                        if (parts[key]) {
                            parts[key].level = state.partsLevels[key];
                        }
                    }
                }
            }
        } catch(e) {
            console.error("–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è:", e);
        }
    }

    // –§—É–Ω–∫—Ü–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –æ—á–∫–æ–≤ FPS
    function updateScoreDisplay() {
        scoreEl.textContent = "FPS: " + Math.floor(points);
    }

    // –§—É–Ω–∫—Ü–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –ø—Ä–æ–≥—Ä–µ—Å—Å–±–∞—Ä–∞ –¥–æ–ª–≥–∞
    function updateDebtDisplay() {
        if (debt > 0) {
            debtLabelEl.style.display = "block";
            debtAmountEl.textContent = debt;
            const fraction = totalDebtIncurred > 0 ? ( (totalDebtIncurred - debt) / totalDebtIncurred ) : 1;
            debtFillEl.style.width = (fraction * 100) + "%";
        } else {
            debtLabelEl.style.display = "none";
            debtFillEl.style.width = "0%";
        }
    }

    // –§—É–Ω–∫—Ü–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –∫—Ä–µ–¥–∏—Ç–Ω—ã—Ö –∫–∞—Ä—Ç (–ª–∏–º–∏—Ç–∞ —Ä–∞—Å—Å—Ä–æ—á–∫–∏)
    function updateCreditDisplay() {
        const creditLeft = 3 - creditCount;
        if (creditLeft <= 0) {
            creditIconsEl.textContent = "‚ùå";
        } else {
            creditIconsEl.textContent = "üí≥".repeat(creditLeft);
        }
    }

    // –§—É–Ω–∫—Ü–∏—è –ø–µ—Ä–µ—Å—á–µ—Ç–∞ FPS –∑–∞ –∫–ª–∏–∫ –Ω–∞ –æ—Å–Ω–æ–≤–µ —É—Ä–æ–≤–Ω–µ–π –∞–ø–≥—Ä–µ–π–¥–æ–≤
    function recalcPointsPerClick() {
        let base = 1;
        let bonus = 0;
        for (let key in parts) {
            bonus += parts[key].level * parts[key].effect;
        }
        pointsPerClick = base + bonus;
    }

    // –§—É–Ω–∫—Ü–∏—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –≤—Å–ø–ª—ã–≤–∞—é—â–µ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è (—Å —Å–∫—Ä—ã—Ç–∏–µ–º —á–µ—Ä–µ–∑ –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å–µ–∫—É–Ω–¥)
    let messageTimeout = null;
    function showMessage(text) {
        messageBoxEl.textContent = text;
        messageBoxEl.style.opacity = "1";
        if (messageTimeout) {
            clearTimeout(messageTimeout);
        }
        // –°–∫—Ä—ã—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ —á–µ—Ä–µ–∑ 3 —Å–µ–∫—É–Ω–¥—ã
        messageTimeout = setTimeout(() => {
            messageBoxEl.textContent = "";
        }, 3000);
    }

    // –§—É–Ω–∫—Ü–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –ø–∞–Ω–µ–ª–∏ "–¢–≤–æ–π –±–∏–ª–¥"
    function updateBuildStatus() {
        partsListEl.innerHTML = ""; // –æ—á–∏—Å—Ç–∏—Ç—å —Å–ø–∏—Å–æ–∫
        for (let key in parts) {
            const part = parts[key];
            const partDiv = document.createElement('div');
            partDiv.className = "part";
            const displayName = part.name;
            const currentLevel = part.level;
            const currentName = part.names[currentLevel];
            // –û—Ç–æ–±—Ä–∞–∂–∞–µ–º –Ω–∞–∑–≤–∞–Ω–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞ –∏ —Ç–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ
            let text = displayName + ": " + currentName;
            if (currentLevel >= part.names.length - 1) {
                text += " (MAX)";
            } else {
                text += " (—É—Ä. " + currentLevel + ")";
            }
            partDiv.textContent = text;
            partsListEl.appendChild(partDiv);
        }
    }

    // –§—É–Ω–∫—Ü–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Ç–µ–∫—Å—Ç–∞ –Ω–∞ –∫–Ω–æ–ø–∫–µ –∞–ø–≥—Ä–µ–π–¥–∞ (—Å—Ç–æ–∏–º–æ—Å—Ç—å –∏–ª–∏ —Å—Ç–∞—Ç—É—Å)
    function updateUpgradeButton(partKey) {
        const part = parts[partKey];
        const button = document.getElementById("btn-" + partKey);
        if (!button) return;
        if (part.level >= part.names.length - 1) {
            // –£—Ä–æ–≤–µ–Ω—å –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π - –æ—Ç–∫–ª—é—á–∏—Ç—å –∫–Ω–æ–ø–∫—É
            button.textContent = "MAX";
            button.disabled = true;
        } else {
            const cost = part.cost[part.level];
            button.textContent = "–ê–ø–≥—Ä–µ–π–¥ " + partGenitive[partKey] + " (" + cost + " FPS)";
            // –ö–Ω–æ–ø–∫–∞ –∞–∫—Ç–∏–≤–Ω–∞, –µ—Å–ª–∏ —Ö–≤–∞—Ç–∞–µ—Ç –æ—á–∫–æ–≤ –∏–ª–∏ –º–æ–∂–Ω–æ –≤ –∫—Ä–µ–¥–∏—Ç
            button.disabled = false;
        }
    }

    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∫–Ω–æ–ø–æ–∫ –∞–ø–≥—Ä–µ–π–¥–æ–≤
    for (let key in parts) {
        const part = parts[key];
        const btn = document.createElement('button');
        btn.className = "upgrade-btn";
        btn.id = "btn-" + key;
        upgradesContainer.appendChild(btn);
        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –Ω–∞–∂–∞—Ç–∏—è –Ω–∞ –∫–Ω–æ–ø–∫—É –∞–ø–≥—Ä–µ–π–¥–∞ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞
        btn.addEventListener('click', function() {
            // –ü—Ä–æ–≤–µ—Ä–∫–∞: –Ω–µ –ø—Ä–µ–≤—ã—à–µ–Ω –ª–∏ –ª–∏–º–∏—Ç –∫—Ä–µ–¥–∏—Ç–æ–≤, –µ—Å–ª–∏ –æ—á–∫–æ–≤ –Ω–µ —Ö–≤–∞—Ç–∞–µ—Ç
            if (points < part.cost[part.level]) {
                // –Ω–µ —Ö–≤–∞—Ç–∞–µ—Ç –æ—á–∫–æ–≤ –¥–ª—è –ø–æ–∫—É–ø–∫–∏
                if (part.level >= part.names.length - 1) {
                    return; // –Ω–∞ –≤—Å—è–∫–∏–π —Å–ª—É—á–∞–π, –µ—Å–ª–∏ —É–∂–µ –º–∞–∫—Å
                }
                // –ü–æ–ø—ã—Ç–∫–∞ –∫—É–ø–∏—Ç—å –≤ –∫—Ä–µ–¥–∏—Ç
                if (creditCount >= 3) {
                    // –ø—Ä–µ–≤—ã—à–µ–Ω –ª–∏–º–∏—Ç —Ä–∞—Å—Å—Ä–æ—á–∫–∏
                    showMessage("–õ–∏–º–∏—Ç —Ä–∞—Å—Å—Ä–æ—á–∫–∏ –∏—Å—á–µ—Ä–ø–∞–Ω! –í—ã–ø–ª–∞—Ç–∏—Ç–µ –¥–æ–ª–≥, —á—Ç–æ–±—ã –≤–∑—è—Ç—å –Ω–æ–≤—ã–π.");
                    return;
                }
            }
            // –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –ø–æ–∫—É–ø–∫–∏ –∞–ø–≥—Ä–µ–π–¥–∞
            const cost = part.cost[part.level];
            let usedCredit = false;
            if (points >= cost) {
                // –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –æ—á–∫–æ–≤ - —Ç—Ä–∞—Ç–∏–º –∏—Ö
                points -= cost;
            } else {
                // –ø–æ–∫—É–ø–∞–µ–º –≤ –∫—Ä–µ–¥–∏—Ç
                usedCredit = true;
                creditCount++;
                // —Å–∫–æ–ª—å–∫–æ –æ—á–∫–æ–≤ –Ω–µ —Ö–≤–∞—Ç–∞–µ—Ç:
                const needed = cost - points;
                points = 0;
                debt += needed;
                if (debt > 0 && totalDebtIncurred === 0) {
                    // –µ—Å–ª–∏ –¥–æ —ç—Ç–æ–≥–æ –¥–æ–ª–≥–∞ –Ω–µ –±—ã–ª–æ, —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –Ω–æ–≤—É—é —Å—É–º–º—É –¥–æ–ª–≥–∞
                    totalDebtIncurred = debt;
                } else if (debt > 0) {
                    // —É–≤–µ–ª–∏—á–∏–≤–∞–µ–º –æ–±—â–∏–π –¥–æ–ª–≥ –Ω–∞ –¥–æ–±–∞–≤–æ—á–Ω—É—é —Å—É–º–º—É
                    totalDebtIncurred += needed;
                }
                showMessage("–ö—É–ø–ª–µ–Ω–æ –≤ —Ä–∞—Å—Å—Ä–æ—á–∫—É –Ω–∞ " + needed + " FPS!");
            }
            // –ü–æ–≤—ã—à–∞–µ–º —É—Ä–æ–≤–µ–Ω—å –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞
            part.level++;
            // –û–±–Ω–æ–≤–ª—è–µ–º FPS –∑–∞ –∫–ª–∏–∫ –ø–æ—Å–ª–µ –∞–ø–≥—Ä–µ–π–¥–∞
            recalcPointsPerClick();
            // –û–±–Ω–æ–≤–ª—è–µ–º –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –Ω–∞–∑–≤–∞–Ω–∏—è –Ω–∞ –≤–∏–¥–µ–æ–∫–∞—Ä—Ç–µ, –µ—Å–ª–∏ —ç—Ç–æ GPU
            if (key === 'gpu') {
                gpuLabelEl.textContent = part.names[part.level];
                // –ï—Å–ª–∏ –¥–æ—Å—Ç–∏–≥–ª–∏ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–≥–æ —É—Ä–æ–≤–Ω—è –≤–∏–¥–µ–æ–∫–∞—Ä—Ç—ã, –¥–æ–±–∞–≤–ª—è–µ–º —ç—Ñ—Ñ–µ–∫—Ç
                if (part.level >= part.names.length - 1) {
                    gpuIconEl.classList.add('maxed');
                }
            }
            // –û–±–Ω–æ–≤–ª—è–µ–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
            updateScoreDisplay();
            updateDebtDisplay();
            updateCreditDisplay();
            updateBuildStatus();
            updateUpgradeButton(key);
            // –°–æ–æ–±—â–µ–Ω–∏–µ –æ –ø—Ä–æ–≤–µ–¥–µ–Ω–Ω–æ–º –∞–ø–≥—Ä–µ–π–¥–µ (—à—É—Ç–∫–∞)
            let joke = "";
            switch(key) {
                case 'gpu':
                    joke = "–¢–µ–ø–µ—Ä—å —É –≤–∞—Å " + part.names[part.level] + "! –ö–∞–¥—Ä—ã –ª–µ—Ç—è—Ç –≤–≤–µ—Ä—Ö.";
                    break;
                case 'cpu':
                    joke = part.names[part.level] + " —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω. –ú–æ–∂–Ω–æ —Ä–∞–∑–≥–æ–Ω—è—Ç—å!";
                    break;
                case 'ram':
                    joke = "–î–æ–±–∞–≤–ª–µ–Ω–æ: " + part.names[part.level] + ". –•–≤–∞—Ç–∏—Ç, —á—Ç–æ–±—ã –æ—Ç–∫—Ä—ã—Ç—å –ø–∞—Ä—É –≤–∫–ª–∞–¥–æ–∫.";
                    break;
                case 'cooler':
                    joke = "–û—Ö–ª–∞–∂–¥–µ–Ω–∏–µ —É–ª—É—á—à–µ–Ω–æ: " + part.names[part.level] + ". –®—É–º —É–º–µ–Ω—å—à–∏–ª—Å—è.";
                    break;
                case 'case':
                    joke = "–ù–æ–≤—ã–π –∫–æ—Ä–ø—É—Å: " + part.names[part.level] + "! –¢–µ–ø–µ—Ä—å –≤—ã–≥–ª—è–¥–∏—Ç –∫—Ä–∞—Å–∏–≤–æ.";
                    break;
            }
            showMessage(joke);
            // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞
            saveState();
        });
    }

    // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–ª–∏–∫–∞/—Ç–∞–ø–∞ –ø–æ —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω–æ–π –∏–∫–æ–Ω–∫–µ (–≤–∏–¥–µ–æ–∫–∞—Ä—Ç–∞)
    const centralEl = document.getElementById('central');
    function handleCentralClick(event) {
        // –ö–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –∫–ª–∏–∫–∞ (—É—á–µ—Ç —Ç–∞—á-—É—Å—Ç—Ä–æ–π—Å—Ç–≤)
        let clientX = event.clientX;
        let clientY = event.clientY;
        if (event.touches && event.touches.length > 0) {
            clientX = event.touches[0].clientX;
            clientY = event.touches[0].clientY;
        }
        // –î–æ–±–∞–≤–ª—è–µ–º –æ—á–∫–∏ (FPS)
        points += pointsPerClick;
        // –ï—Å–ª–∏ –µ—Å—Ç—å –¥–æ–ª–≥, –ø–æ–≥–∞—à–∞–µ–º –µ–≥–æ –≤ –ø–µ—Ä–≤—É—é –æ—á–µ—Ä–µ–¥—å
        if (debt > 0) {
            if (points >= debt) {
                // —Ö–≤–∞—Ç–∞–µ—Ç –Ω–∞–±—Ä–∞–Ω–Ω—ã—Ö –æ—á–∫–æ–≤, —á—Ç–æ–±—ã –∑–∞–∫—Ä—ã—Ç—å –¥–æ–ª–≥
                points -= debt;
                debt = 0;
                // –¥–æ–ª–≥ –≤—ã–ø–ª–∞—á–µ–Ω, —Å–±—Ä–∞—Å—ã–≤–∞–µ–º —Å—á–µ—Ç—á–∏–∫ –∫—Ä–µ–¥–∏—Ç–æ–≤
                creditCount = 0;
                totalDebtIncurred = 0;
                showMessage("–î–æ–ª–≥ –≤—ã–ø–ª–∞—á–µ–Ω! –ú–æ–∂–Ω–æ –±—Ä–∞—Ç—å –Ω–æ–≤—ã–µ –∞–ø–≥—Ä–µ–π–¥—ã –≤ –∫—Ä–µ–¥–∏—Ç.");
            } else {
                // –Ω–µ –≤–µ—Å—å –¥–æ–ª–≥ –∑–∞–∫—Ä—ã—Ç, –æ—Ç–Ω–∏–º–∞–µ–º –≤—Å–µ –æ—á–∫–∏ –≤ —Å—á–µ—Ç –¥–æ–ª–≥–∞
                debt -= points;
                points = 0;
            }
        }
        // –û–±–Ω–æ–≤–ª—è–µ–º —Å—á–µ—Ç—á–∏–∫–∏ –∏ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
        updateScoreDisplay();
        updateDebtDisplay();
        updateCreditDisplay();
        // –ê–Ω–∏–º–∞—Ü–∏—è: –≤—ã–ª–µ—Ç–∞—é—â–∞—è —á–∞—Å—Ç–∏—Ü–∞ —Å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –ø–æ–ª—É—á–µ–Ω–Ω–æ–≥–æ FPS
        const particle = document.createElement('span');
        particle.className = "particle";
        particle.textContent = "+" + pointsPerClick;
        // –†–∞–∑–º–µ—â–∞–µ–º —á–∞—Å—Ç–∏—Ü—É –≤ —Ç–æ—á–∫–µ –∫–ª–∏–∫–∞
        const rect = centralEl.getBoundingClientRect();
        particle.style.left = (clientX - rect.left) + "px";
        particle.style.top = (clientY - rect.top) + "px";
        centralEl.appendChild(particle);
        // –£–¥–∞–ª—è–µ–º —ç–ª–µ–º–µ–Ω—Ç —á–∞—Å—Ç–∏—Ü—ã –ø–æ—Å–ª–µ –∞–Ω–∏–º–∞—Ü–∏–∏
        setTimeout(() => {
            particle.remove();
        }, 1000);
        // –î–æ–±–∞–≤–ª—è–µ–º –∫—Ä–∞—Ç–∫–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π —ç—Ñ—Ñ–µ–∫—Ç –Ω–∞ —Å–∞–º—É –≤–∏–¥–µ–æ–∫–∞—Ä—Ç—É (–º–∞—Å—à—Ç–∞–±/—Å–≤–µ—á–µ–Ω–∏–µ)
        gpuIconEl.classList.add('clicked');
        setTimeout(() => {
            gpuIconEl.classList.remove('clicked');
        }, 100);
        // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ (–æ—á–∫–æ–≤ –∏ –¥–æ–ª–≥–∞)
        saveState();
    }
    // –ù–∞–∑–Ω–∞—á–∞–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∫–ª–∏–∫–∞/—Ç–∞—á–∞ –Ω–∞ —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π —ç–ª–µ–º–µ–Ω—Ç
    centralEl.addEventListener('click', handleCentralClick);
    centralEl.addEventListener('touchstart', function(e) {
        e.preventDefault();
        handleCentralClick(e);
    });

    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ –ø–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏/—Å–±—Ä–æ—Å–∞
    function initUI() {
        // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –º–µ—Ç–∫—É —Ç–µ–∫—É—â–µ–π –≤–∏–¥–µ–æ–∫–∞—Ä—Ç—ã –Ω–∞ —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω–æ–π –∫–∞—Ä—Ç–µ
        gpuLabelEl.textContent = parts.gpu.names[parts.gpu.level];
        // –ï—Å–ª–∏ –≤–∏–¥–µ–æ–∫–∞—Ä—Ç–∞ –±—ã–ª–∞ –º–∞–∫—Å-—É—Ä–æ–≤–Ω—è, –≤–∫–ª—é—á–∞–µ–º —Å–≤–µ—á–µ–Ω–∏–µ
        if (parts.gpu.level >= parts.gpu.names.length - 1) {
            gpuIconEl.classList.add('maxed');
        }
        // –û–±–Ω–æ–≤–ª—è–µ–º –≤—Å–µ —ç–ª–µ–º–µ–Ω—Ç—ã –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
        updateScoreDisplay();
        updateDebtDisplay();
        updateCreditDisplay();
        updateBuildStatus();
        // –û–±–Ω–æ–≤–ª—è–µ–º —Ç–µ–∫—Å—Ç –∏ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –≤—Å–µ—Ö –∫–Ω–æ–ø–æ–∫ –∞–ø–≥—Ä–µ–π–¥–æ–≤
        for (let key in parts) {
            updateUpgradeButton(key);
        }
    }

    // –ó–∞–≥—Ä—É–∑–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è, –µ—Å–ª–∏ –µ—Å—Ç—å
    loadState();
    // –ü–µ—Ä–µ—Å—á–µ—Ç FPS –∑–∞ –∫–ª–∏–∫ –Ω–∞ –æ—Å–Ω–æ–≤–µ –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã—Ö –∞–ø–≥—Ä–µ–π–¥–æ–≤
    recalcPointsPerClick();
    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ —Å —É—á–µ—Ç–æ–º –∑–∞–≥—Ä—É–∂–µ–Ω–Ω–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è
    initUI();
});
</script>

</body>
</html>
